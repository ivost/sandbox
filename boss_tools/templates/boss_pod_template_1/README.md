# boss_pod_template

boss_pod_template is a project template for web service pod and utility cli  

## WORK IN PROGRESS

### based on code from "Go microservice template for Kubernetes" https://github.com/stefanprodan/podinfo

## Use *minimal* branch for lightweight version

## How to get started

```

cd /tmp
git clone git@github.com:braincorp/boss_pod_template.git --branch minimal

cd /tmp/boss_pod_template

make build

mkdir ~/myservice
cd ~/myservice
boss_pod_template --clone

```

last line will create new service tree under my_service with all "boss_pod_template" replaced with "my_service".

```

```
Then you can try
```
make help
make test
make run

http :8080/version 

or 

curl localhost:8080/version

remove stuff you don't need, rename podcli, podinfo as needed


```

###Specifications:

* Best practices for running microservices in Kubernetes.
* Dependency Injection
* Health checks (readiness and liveness probes)
* Graceful shutdown on interrupt signals
* File watcher for secrets and configmaps changes
* Instrumented with Prometheus
* Tracing with Istio and Jaeger
* Authentication with JWT token
* Structured logging with zap 
* 12-factor app with viper
* Fault injection (random errors and latency)
* Autogenerated Swagger docs
* Deploy to Kubernetes via Kustomize configuration

see make help for make targets

To generate swagger docs
`make docs`
 
To build locally
`make build`

To create new project by cloning the template
```text
1. Create/clone empty github repo - i.e. boss_service
2. cd boss_service
3. podcli code init
4. add/push initial code
5. customize at will  
```

To access the Swagger UI:
```text
1. make run
2. open http://localhost:8080/swagger/index.html in a browser
```

### Guides

* [Kubernetes native configuration management with kustomize](https://kustomize.io)
* [Automated canary deployments with Flagger and Istio](https://medium.com/google-cloud/automated-canary-deployments-with-flagger-and-istio-ac747827f9d1)
* [Kubernetes autoscaling with Istio metrics](https://medium.com/google-cloud/kubernetes-autoscaling-with-istio-metrics-76442253a45a)


### Install

Kustomize:

```bash
kubectl apply -k github.com/braincorp/boss_pod_template/kustomize
```

Docker:

```bash
docker run -d -p 8080:8080 930325689781.dkr.ecr.us-west-2.amazonaws.com/boss_pod_template
```